<html>
<head>
  <!-- We use client cookies to save the user credentials -->
  <script src="//code.angularjs.org/1.2.16/angular.min.js"></script>
  <script src="//code.angularjs.org/1.2.16/angular-cookies.min.js"></script>

  <!-- Auth0 Lock script and AngularJS module -->
  <script src="//cdn.auth0.com/js/lock-7.0.min.js"></script>
  <!-- angular-jwt and angular-storage -->
  <script type="text/javascript" src="//cdn.rawgit.com/auth0/angular-storage/master/dist/angular-storage.js"></script>
  <script type="text/javascript" src="//cdn.rawgit.com/auth0/angular-jwt/master/dist/angular-jwt.js"></script>

  <script src="//cdn.auth0.com/w2/auth0-angular-4.js"> </script>
  <script>
    var AUTH0_CONFIG = {
      domain: '<%= AUTH0_DOMAIN %>',
      clientID: '<%= AUTH0_CLIENT_ID %>'
    }
  </script>
  <script src="/js/app.js"></script>

  <!-- Setting the right viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>
<body ng-app="unboxApp">
  <div ng-controller="unboxAppLoginController">
    <div ng-show="auth.isAuthenticated">
      <span>Welcome back, {{auth.profile.nickname}}!</span>
      <input type="submit" ng-show="auth.isAuthenticated === true" ng-click="logout()" value="Log out" />
    </div>
    <div ng-show="!auth.isAuthenticated">
      <span>Hello!</span>
      <input type="submit"  ng-click="login()" value="Log in" />
    </div>
  </div>
  <div ng-controller="unboxAppUserController" ng-show="auth.isAuthenticated">
    <h3>Your products</h3>
    <div>
      <ul>
        <li ng-repeat="product in products.products">{{ product.model }} {{ product.sn }}</li>
      </ul>
      <button ng-click="addProduct()">
        Add Product
      </button>
    </div>
    <div id="addProduct" ng-show="addingProduct">
      <div ng-show="models === null">
        Loading models...
      </div>
      <div ng-hide="models === null">
        Select a product model to add:
        <ul>
          <li ng-repeat="model in models">{{ model.friendly }} <button ng-click="selectProductToAdd(model)">Add</button></li>
        </ul>
      </div>
      <div id="addSerialNumber" ng-show="selectedModel !== null">
        <div>
          Enter serial number of the {{ selectedModel.friendly }}:
          <div>
            <input ng-model="serialNumberToAdd"></input>
            <button ng-click="addProductBySerialNumber(selectedModel);">Add this product</button>
            <span>{{ error }}</span>
          </div>
        </div>
        <div>
          <div>Example SN: {{ selectedModel.exampleSN }}</div>
          <div>SN picture: <img src="{{ selectedModel.pictureSN }}" /></div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
